# 🧮 けいさんドリル作成ツール

小学生向けの算数ドリルを自動生成するWebアプリケーションです。PythonとStreamlitを使用して開発されており、直感的なインターフェースで簡単に算数問題を作成できます。

## ✨ 主な機能

### 🎯 問題生成
- **6種類の問題形式**: 足し算・引き算・足し引き混合・かけ算・わり算・四則混合
- **柔軟な項数設定**: 2項から5項まで対応
- **2つの生成モード**: 通常モード（ランダム生成）と網羅モード（全組み合わせ）
- **問題数調整**: 10問から100問まで設定可能

### ⚙️ 詳細カスタマイズ
- **数値範囲設定**: 各演算で使用する数の範囲を個別に設定
- **制約条件**: 答えの範囲制限、負の値の許可、余りの有無など
- **順序設定**: 昇順（数値順）またはランダム順

### 🖨️ 出力オプション
- **PDF自動生成**: 問題生成と同時にPDFファイルを自動ダウンロード
- **ブラウザ印刷**: ブラウザの印刷機能で直接印刷
- **表示カスタマイズ**: 解答欄の表示/非表示、フォントサイズ調整
- **A4最適化**: 印刷に最適化されたレイアウト

## 🚀 クイックスタート

### 必要な環境
- **Python**: 3.8以上
- **OS**: Windows 10/11（推奨）
- **ブラウザ**: Chrome, Firefox, Edge（最新版）

### インストールと起動

1. **アプリケーションの起動**
   ```bash
   # math_creator.batをダブルクリック
   # または
   python main.py
   ```

2. **初回起動時**
   - 必要な依存関係が自動的にインストールされます
   - ブラウザが自動的に開き、アプリケーションが表示されます

## 📖 使い方

### 1. 基本設定（サイドバー）
- **問題形式**: 生成したい演算の種類を選択
- **項数**: 1問あたりの項数を2〜5項から選択
- **生成方法**: 通常モード（ランダム）または網羅モード（全組み合わせ）
- **問題数**: 生成する問題数を設定（網羅モードの場合は自動計算）
- **順序**: 昇順またはランダム順を選択

### 2. 詳細設定（オプション）
「⚙️ 詳細設定ページ」ボタンで以下の設定が可能：
- **数値範囲**: 各演算で使用する数の最小・最大値を設定
- **制約設定**: 答えの範囲制限や条件を設定
- **表示設定**: 解答欄の表示方法やフォントサイズを調整

### 3. 問題生成
「🎯 問題生成」ボタンをクリックすると：
- 設定に基づいて問題が生成されます
- PDFファイルが自動的にダウンロードされます
- 画面に問題が表示され、確認できます

### 4. 印刷・出力
- **自動PDF**: 問題生成時に自動ダウンロード
- **ブラウザ印刷**: Ctrl+Pで印刷ダイアログを開く
- **印刷設定**: 「背景のグラフィック」を有効にすると見やすくなります

## 🎨 機能詳細

### 問題形式の例

| 形式 | 2項の例 | 3項の例 |
|------|---------|---------|
| 足し算 | 3 + 5 | 3 + 5 + 2 |
| 引き算 | 7 - 3 | 10 - 3 - 2 |
| かけ算 | 4 × 6 | 4 × 6 × 2 |
| わり算 | 12 ÷ 3 | 24 ÷ 3 ÷ 2 |

### 制約設定の種類

- **足し算**: 合計が10以下、11-20、制限なし
- **引き算**: 正の整数のみ、負の値も許可
- **かけ算**: 積が100以下、制限なし
- **わり算**: 余りなし、余りあり

### 生成モードの違い

- **通常モード**: 設定された範囲内でランダムに問題を生成
- **網羅モード**: 指定された範囲の全組み合わせを生成（例：1-5の範囲なら25問）

## 📁 ファイル構成

```
math_creator/
├── main.py                 # メインアプリケーション
├── output_formatter.py     # PDF生成・表示フォーマット
├── detailed_settings.py    # 詳細設定ページ
├── display_settings.py     # 表示設定ページ
├── usage_guide.py         # 使い方ガイド
├── requirements.txt       # Python依存関係
├── math_creator.bat       # Windows起動スクリプト
├── pages/                 # Streamlitページ
│   ├── 1_詳細設定.py
│   └── 2_表示設定.py
└── _reference/            # 参考資料
    └── vba.bas           # 元のVBAコード
```

## 🛠️ 技術仕様

- **フレームワーク**: Streamlit 1.28.1
- **PDF生成**: ReportLab 4.0.4
- **データ処理**: Pandas, NumPy
- **言語**: Python 3.8+
- **フォント**: 日本語フォント対応（UnicodeCIDFont）
  - ReportLab標準の日本語フォント
  - Windows/macOS標準フォント対応
  - フォールバック機能付き

## 🔧 トラブルシューティング

### よくある問題

**Q: アプリケーションが起動しない**
- Python 3.8以上がインストールされているか確認
- ファイアウォールの設定を確認
- ポート8501が使用可能か確認

**Q: PDFが正しく表示されない**
- ブラウザのPDFビューアーを確認
- 日本語フォントが正しくインストールされているか確認

**Q: 依存関係のエラーが発生**
- 仮想環境を削除して再作成
- `pip install -r requirements.txt`を手動実行

### パフォーマンス最適化

- **大量の問題生成**: 網羅モードで100問以上生成する場合は時間がかかる場合があります
- **メモリ使用量**: 複雑な設定や大量の問題生成時はメモリ使用量が増加します

## 📝 更新履歴

### v2.0.0 (現在)
- StreamlitベースのWebアプリケーションに完全移行
- PDF自動生成機能を追加
- 詳細設定ページと表示設定ページを分離
- 使い方ガイドを追加
- 日本語フォント対応（UnicodeCIDFont）
- 高品質な日本語PDF出力

### v1.0.0
- VBAからPython/Streamlitへの初回変換
- 基本的な問題生成機能

## 🤝 貢献

このプロジェクトは教育目的で作成されています。改善提案やバグ報告は歓迎します。

## 📄 ライセンス

このプロジェクトは教育目的で作成されており、自由に使用・改変できます。

## 📞 サポート

問題や質問がある場合は、GitHubのIssuesページでお知らせください。

---

**開発者**: 教育アプリ開発チーム  
**最終更新**: 2024年 